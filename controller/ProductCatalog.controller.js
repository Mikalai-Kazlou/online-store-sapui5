sap.ui.define(["./BaseController","sap/ui/model/Filter","sap/ui/model/FilterType","sap/ui/model/FilterOperator","sap/m/ButtonType"],function(t,e,o,n,i){"use strict";return t.extend("com.exercise.onlinestoresapui5.controller.ProductCatalog",{onInit:function(){const t=this.getRouter();t.getRoute("main").attachPatternMatched(this._onPatternMatched,this)},_onPatternMatched:function(){const t=this.byId("idProductCatalog");const e=t.getItems();this._setAddToCartButtonsAttributes(e)},onOpenDetails:function(t){const e=t.getSource();this.navTo("details",{path:window.encodeURIComponent(e.getBindingContext("mockdata").getPath().slice(1))})},onProductCatalogUpdateFinished(t){const e=t.getSource();const o=e.getItems();const n=o.map(t=>t.getBindingContext("mockdata").getObject());this._setRangeFilterAttributes(this.byId("idFilterPrice"),n,"Price");this._setRangeFilterAttributes(this.byId("idFilterStock"),n,"Stock");this._setAddToCartButtonsAttributes(o)},_setAddToCartButtonsAttributes:function(t){t.forEach(t=>{const e=t.getBindingContext("mockdata").getObject();const o=t.getContent()[0].getControlsByFieldGroupId("idAddToCartButtonGroup")[0];this._setAddToCartButtonAttributes(e.ID,o)})},_setAddToCartButtonAttributes:function(t,e){const o=this.getResourceBundle();if(this.oCart.has(t)){e.setType(i.Success);e.setText(o.getText("productCatalogDropFromCartButtonText"))}else{e.setType(i.Default);e.setText(o.getText("productCatalogAddToCartButtonText"))}},_setRangeFilterAttributes(t,e,o){if(!t.getRange()[0]){const n=e.reduce((t,e)=>t<e[o]?t:e[o],Number.MAX_SAFE_INTEGER);const i=e.reduce((t,e)=>t>e[o]?t:e[o],0);t.setMin(n);t.setMax(i);t.setRange([n,i])}},_applyFilters:function(t,e){const n=this.byId("idProductCatalog");const i=n.getBinding("items");let s=i.getFilters(o.Application);s=s.filter(t=>t.getPath()!==e);s=[...s,...t];i.filter(s,o.Application)},_applyListFilter:function(t,o){const i=[];const s=t.getSource().getSelectedItems();s.forEach(t=>{i.push(new e(o,n.EQ,t.getTitle()))});this._applyFilters(i,o)},_applyRangeFilter:function(t,o){const i=[];const s=t.getSource().getRange();i.push(new e(o,n.BT,s[0],s[1]));this._applyFilters(i,o)},onSearch:function(t){const o=[];const i=t.getSource().getValue();if(i&&i.length>0){o.push(new e("Title",n.Contains,i))}this._applyFilters(o,"Title")},onFilterCategorySelectionChange:function(t){this._applyListFilter(t,"Category")},onFilterBrandSelectionChange:function(t){this._applyListFilter(t,"Brand")},onFilterPriceChange:function(t){this._applyRangeFilter(t,"Price")},onFilterStockChange:function(t){this._applyRangeFilter(t,"Stock")},onAddToCart:function(t){const e=t.getSource();const o=e.getBindingContext("mockdata");const n=o.getObject();if(!this.oCart.has(n.ID)){this.oCart.add(n.ID,1)}else{this.oCart.drop(n.ID)}this._refreshCartModel();this._refreshLocalDataModel();this._setAddToCartButtonAttributes(n.ID,e)}})});
//# sourceMappingURL=ProductCatalog.controller.js.map